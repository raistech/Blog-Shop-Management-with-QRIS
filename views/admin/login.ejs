<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - RSA Store</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .login-box {
            max-width: 450px;
            width: 100%;
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .login-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            color: white;
            box-shadow: var(--shadow-glow);
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-box">
            <div class="login-header">
                <div class="login-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h1>Admin Panel</h1>
                <p style="color: var(--text-secondary);">RSA Store Management</p>
            </div>
            
            <div class="card">
                <% if (error) { %>
                    <div class="alert alert-error">
                        <i class="fas fa-exclamation-circle"></i>
                        <%= error %>
                    </div>
                <% } %>
                
                <form method="POST" action="/admin/login">
                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                    <% if (!require2FA) { %>
                        <!-- Username & Password -->
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-user"></i>
                                Username
                            </label>
                            <input 
                                type="text" 
                                name="username" 
                                class="form-input" 
                                placeholder="Enter your username" 
                                required
                                autofocus
                            >
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-lock"></i>
                                Password
                            </label>
                            <div style="position: relative;">
                                <input 
                                    type="password" 
                                    name="password" 
                                    id="password"
                                    class="form-input" 
                                    placeholder="••••••••" 
                                    required
                                >
                                <button 
                                    type="button" 
                                    onclick="togglePassword()"
                                    style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--text-muted); cursor: pointer;"
                                >
                                    <i class="fas fa-eye" id="password-eye"></i>
                                </button>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            <i class="fas fa-sign-in-alt"></i>
                            Login
                        </button>
                    <% } else { %>
                        <!-- 2FA Token Input -->
                        <input type="hidden" name="username" id="hidden_username" value="<%= tempUsername %>">
                        <input type="hidden" name="password" id="hidden_password" value="">
                        
                        <div class="alert alert-info">
                            <i class="fas fa-mobile-alt"></i>
                            2FA aktif untuk akun ini. Masukkan kode dari authenticator app Anda.
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-key"></i>
                                Kode 2FA (6 digit)
                            </label>
                            <input 
                                type="text" 
                                name="token_2fa" 
                                class="form-input" 
                                placeholder="000000" 
                                required
                                maxlength="6"
                                pattern="[0-9]{6}"
                                autofocus
                                style="text-align: center; font-size: 1.5rem; letter-spacing: 0.5rem; font-family: monospace;"
                            >
                            <p class="form-help">Masukkan 6 digit kode dari Google Authenticator atau Authy</p>
                        </div>
                        
                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            <i class="fas fa-check"></i>
                            Verifikasi & Login
                        </button>
                        
                        <a href="/admin/login" class="btn btn-secondary" style="width: 100%; margin-top: 0.5rem;">
                            <i class="fas fa-arrow-left"></i>
                            Kembali
                        </a>
                    <% } %>
                </form>
                
                <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color); text-align: center;">
                    <a href="/" style="color: var(--text-muted); font-size: 0.875rem;">
                        <i class="fas fa-home"></i>
                        Kembali ke Homepage
                    </a>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 1.5rem; color: var(--text-muted); font-size: 0.875rem;">
                <i class="fas fa-lock"></i>
                Secure Admin Authentication
            </div>
        </div>
    </div>
    
    <script>
        function togglePassword() {
            const field = document.getElementById('password');
            const icon = document.getElementById('password-eye');
            
            if (field.type === 'password') {
                field.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                field.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }
    </script>
</body>
</html>
